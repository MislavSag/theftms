<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="theft">
<title>Introduction to theft • theft</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to theft">
<meta property="og:description" content="theft">
<meta property="og:image" content="https://hendersontrent.github.io/theft/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">theft</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/theft.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hendersontrent/theft/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to theft</h1>
                        <h4 data-toc-skip class="author">Trent
Henderson</h4>
            
            <h4 data-toc-skip class="date">2023-08-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hendersontrent/theft/blob/HEAD/vignettes/theft.Rmd" class="external-link"><code>vignettes/theft.Rmd</code></a></small>
      <div class="d-none name"><code>theft.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hendersontrent.github.io/theft/">theft</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p><code>theft</code> facilitates user-friendly access to a structured
analytical workflow for the extraction, analysis, and visualisation of
time-series features. This structured workflow is presented in the
graphic below (note that <code>theft</code> has many more functions than
displayed in this graphic—keep reading for more):</p>
<p><img src="workflow-graphic_v05.png" width="700" alt="Structured workflow of the theft package for R"></p>
</div>
<div class="section level2">
<h2 id="core-calculation-functions">Core calculation functions<a class="anchor" aria-label="anchor" href="#core-calculation-functions"></a>
</h2>
<p>To explore package functionality, we are going to use a dataset that
comes standard with <code>theft</code> called <code>simData</code>. This
dataset contains a collection of randomly generated time series for six
different types of processes. The dataset can be accessed via:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">theft</span><span class="fu">::</span><span class="va"><a href="../reference/simData.html">simData</a></span></span></code></pre></div>
<p>The data follows the following structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simData</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      values timepoint               id        process</span></span>
<span><span class="co">#&gt; Gaussian Noise.1 -0.6264538         1 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.2  0.1836433         2 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.3 -0.8356286         3 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.4  1.5952808         4 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.5  0.3295078         5 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.6 -0.8204684         6 Gaussian Noise_1 Gaussian Noise</span></span></code></pre></div>
<div class="section level3">
<h3 id="calculating-feature-summary-statistics">Calculating feature summary statistics<a class="anchor" aria-label="anchor" href="#calculating-feature-summary-statistics"></a>
</h3>
<p>The core function that automates the calculation of the feature
statistics at once is <code>calculate_features</code>. You can choose
which subset of features to calculate with the <code>feature_set</code>
argument. The choices are currently <code>"catch22"</code>,
<code>"feasts"</code>, <code>"Kats"</code>, <code>"tsfeatures"</code>,
<code>"tsfresh"</code>, and/or <code>"TSFEL"</code>.</p>
<p>Note that <code>Kats</code>, <code>tsfresh</code> and
<code>TSFEL</code> are Python packages. The R package
<code>reticulate</code> is used to call Python code that uses these
packages and applies it within the broader <em>tidy</em> data philosophy
embodied by <code>theft</code>. At present, depending on the input
time-series, <code>theft</code> provides access to <span class="math inline">\(&gt;1200\)</span> features.</p>
<div class="section level4">
<h4 id="installing-python-feature-sets">Installing Python feature sets<a class="anchor" aria-label="anchor" href="#installing-python-feature-sets"></a>
</h4>
<p>Prior to using <code>theft</code> (only if you want to use the
<code>Kats</code>, <code>tsfresh</code> or <code>TSFEL</code> feature
sets; the R-based sets will run fine) you should have a working Python
3.9 installation and run the function
<code>install_python_pkgs(python_path, path)</code> after first
installing <code>theft</code>, where the <code>python_path</code>
argument is the filepath to the location of Python 3.9 on your machine
and the <code>path</code> argument is the location you wish to install
the Python libraries and virtual environment to on your machine.</p>
<p>For example, if you wanted to install the Python libraries and the
resulting virtual environment in
<code>"C:/Users/User/Desktop/theft"</code> and Python 3.9 is located at
<code>"/usr/bin/python"</code> on your machine, you would run the
following after first having installed <code>theft</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/install_python_pkgs.html">install_python_pkgs</a></span><span class="op">(</span><span class="st">"C:/Users/User/Desktop/theft"</span>, <span class="st">"/usr/bin/python"</span><span class="op">)</span></span></code></pre></div>
<p>If you want to use any of the Python-based packages, you must first
tell R which Python and/or virtual environment on your computer contains
the installed libraries. This can be done in <code>theft</code> via the
<code>init_theft</code> function, which has two arguments:</p>
<ol style="list-style-type: decimal">
<li>
<code>python_path</code> – the filepath to the version of Python you
wish to use (i.e., the same as was entered into
<code>install_python_pkgs</code> if you ran that first)</li>
<li>
<code>venv_path</code> – the filepath to the Python virtual
environment where <code>tsfresh</code>, <code>TSFEL</code>, and/or
<code>Kats</code> are installed (i.e., the path returned in the console
message from <code>install_python_pkgs</code> if you ran that function
first)</li>
</ol>
<p>However, you do not necessarily have to use this convenience
function. If you have another method for pointing R to the correct
Python (such as <code>reticulate</code> or <code>findpython</code>), you
can use those in your workflow instead.</p>
<p><strong>NOTE: You only need to call </strong> <code>init_theft</code>
<strong>or your other solution once per session.</strong></p>
</div>
<div class="section level4">
<h4 id="calculating-features">Calculating features<a class="anchor" aria-label="anchor" href="#calculating-features"></a>
</h4>
<p>You are then ready to use the rest of the package’s functionality,
beginning with the extraction of time-series features. Here is an
example with the <code>catch22</code> set:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_features.html">calculate_features</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simData</span>, </span>
<span>                                     id_var <span class="op">=</span> <span class="st">"id"</span>, </span>
<span>                                     time_var <span class="op">=</span> <span class="st">"timepoint"</span>, </span>
<span>                                     values_var <span class="op">=</span> <span class="st">"values"</span>, </span>
<span>                                     group_var <span class="op">=</span> <span class="st">"process"</span>, </span>
<span>                                     feature_set <span class="op">=</span> <span class="st">"catch22"</span>,</span>
<span>                                     seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>Note that for the <code>catch22</code> set you can set the additional
<code>catch24</code> argument to calculate the mean and standard
deviation in addition to the standard 22 features:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_features.html">calculate_features</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simData</span>, </span>
<span>                                     id_var <span class="op">=</span> <span class="st">"id"</span>, </span>
<span>                                     time_var <span class="op">=</span> <span class="st">"timepoint"</span>, </span>
<span>                                     values_var <span class="op">=</span> <span class="st">"values"</span>, </span>
<span>                                     group_var <span class="op">=</span> <span class="st">"process"</span>, </span>
<span>                                     feature_set <span class="op">=</span> <span class="st">"catch22"</span>,</span>
<span>                                     catch24 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>A tidy dataframe of <em>most</em> of the included features and the
set they correspond to is available in the dataframe
<code>feature_list</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">feature_list</span><span class="op">)</span></span>
<span><span class="co">#&gt;   feature_set                  feature</span></span>
<span><span class="co">#&gt; 1     catch22       DN_HistogramMode_5</span></span>
<span><span class="co">#&gt; 2     catch22      DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 3     catch22                CO_f1ecac</span></span>
<span><span class="co">#&gt; 4     catch22           CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 5     catch22 CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 6     catch22            CO_trev_1_num</span></span></code></pre></div>
<p>NOTE: If using the <code>tsfresh</code> feature set, you might want
to consider the <code>tsfresh_cleanup</code> argument to
<code>calculate_features</code>. This argument defaults to
<code>FALSE</code> and specifies whether to use the in-built
<code>tsfresh</code> relevant feature filter or not.</p>
</div>
</div>
<div class="section level3">
<h3 id="comparison-of-feature-sets">Comparison of feature sets<a class="anchor" aria-label="anchor" href="#comparison-of-feature-sets"></a>
</h3>
<p>For a detailed comparison of the six feature sets, see <a href="https://ieeexplore.ieee.org/document/9679937" class="external-link">this paper</a> for a
detailed review<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;T. Henderson and B. D. Fulcher, “An Empirical Evaluation
of Time-Series Feature Sets,” 2021 International Conference on Data
Mining Workshops (ICDMW), 2021, pp. 1032-1038, doi:
10.1109/ICDMW53433.2021.00134.&lt;/p&gt;"><sup>1</sup></a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-quality-checks">Data quality checks<a class="anchor" aria-label="anchor" href="#data-quality-checks"></a>
</h2>
<p>The <code>calculate_features</code> function returns an object of
class <code>feature_calculations</code>. Objects of this type are
purposefully looked-for by other functions in <code>theft</code>.
Because it is a class, simple methods such as <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can be
called on the object to produce a range of statistical graphics. The
first is a visualisation of the data types of the calculated feature
vectors. This is useful for inspecting which features might need to be
dropped due to large proportions of undesirable (e.g., <code>NA</code>,
<code>NaN</code> etc.) values. We can specify the plot
<code>type = "quality</code> to make this graphic:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"quality"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="normalisingscaling-functions">Normalising/scaling functions<a class="anchor" aria-label="anchor" href="#normalisingscaling-functions"></a>
</h2>
<p>Putting calculated feature vectors on an equal scale is crucial for
any statistical or machine learning model as variables with high
variance can adversely impact the model’s capacity to fit the data
appropriately, learn appropriate weight values, or minimise a loss
function. <code>theft</code> includes function <code>normalise</code> to
rescale either the whole <code>feature_calculations</code> object, or a
single vector of values (e.g. values for all participants on just the
<code>SB_BinaryStats_mean_longstretch1</code> feature). Four
normalisation methods are offered:</p>
<ul>
<li>z-score – <code>"z-score"</code>
</li>
<li>Sigmoid – <code>"Sigmoid"</code>
</li>
<li>Outlier-robust Sigmoid (credit to Ben Fulcher for creating the
original <a href="https://github.com/benfulcher/hctsa" class="external-link">MATLAB
version</a>) - <code>"RobustSigmoid"</code>
</li>
<li>Min-max – <code>"MinMax"</code>
</li>
</ul>
<p>Normalisation on the whole <code>feature_calculations</code> object
can be performed in one line:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span><span class="va">feature_matrix</span>, norm_method <span class="op">=</span> <span class="st">"z-score"</span>, unit_int <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>For single vector normalisation, all you need to do is pass in a
vector as <code>normalise</code> checks for object classes. If you wish
to rescale values into the unit interval <span class="math inline">\([0,1]\)</span> after applying the selected
normalisation method, you can set <code>unit_int = TRUE</code>.</p>
</div>
<div class="section level2">
<h2 id="data-visualisation-and-low-dimensional-projections">Data visualisation and low-dimensional projections<a class="anchor" aria-label="anchor" href="#data-visualisation-and-low-dimensional-projections"></a>
</h2>
<p>The package also comes with additional statistical and graphical
functionality:</p>
<ul>
<li>Feature by time-series matrix as a heatmap</li>
<li>Low dimensional projections of the feature space and plotting as a
scatterplot</li>
<li>Pairwise feature correlation matrix as a heatmap</li>
</ul>
<div class="section level3">
<h3 id="feature-matrices">Feature matrices<a class="anchor" aria-label="anchor" href="#feature-matrices"></a>
</h3>
<p>The function calling <code>type = "matrix"</code> in
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on a <code>feature_calculations</code> object takes
itand produces a <code>ggplot</code> object heatmap showing the feature
vectors across the <code>x</code> axis and each time series down the
<code>y</code> axis. Prior to plotting, the function hierarchically
clusters the data across both rows and columns to visually highlight the
empirical structure. Note that you have several options for the
hierarchical clustering linkage algorithm to use:</p>
<ul>
<li>
<code>"average"</code> (default)</li>
<li><code>"ward.D"</code></li>
<li><code>"ward.D2"</code></li>
<li><code>"single"</code></li>
<li><code>"complete"</code></li>
<li><code>"mcquitty"</code></li>
<li><code>"median"</code></li>
<li><code>"centroid"</code></li>
</ul>
<p>See the <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/hclust" class="external-link"><code>hclust</code>
documentation</a> for more information.</p>
<p>Note that the legend for this plot (and other matrix visualisations
in <code>theft</code>) have been discretised for visual clarity as
continuous legends can be difficult to interpret meaningful value
differences easily.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"matrix"</span>, norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>You can control the normalisation type with the
<code>norm_method</code> argument, whether to rescale to the unit
interval after normalisation with the <code>unit_int</code> argument,
and the hierarchical clustering method with the
<code>clust_method</code> argument (the example above used defaults so
manual specification was not needed).</p>
</div>
<div class="section level3">
<h3 id="individual-feature-distributions">Individual feature distributions<a class="anchor" aria-label="anchor" href="#individual-feature-distributions"></a>
</h3>
<p>Plotting the entire feature matrix is useful, but sometimes we wish
to understand the distributions of individual features. This is
particularly useful if there are different groups in your data (such as
in a time-series classification context). We can again use the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic here to draw violin plots through setting
<code>type = "violin"</code>. Note that for violin plots, we also need
to tell the function which features we wish to plot (i.e., a vector of
characters specifying feature names from the <code>names</code> column
in your <code>feature_calculations</code> object). For simplicity, we
will just plot two random features from <code>catch22</code> here:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"violin"</span>, </span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that when using these defined <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generics, you
can pass any additional arguments to certain geoms to control the plot
look through the <code>...</code> argument in the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function. Below is a guide to where these arguments go depending on the
plot type:</p>
<ul>
<li>
<code>type = "quality"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code>
</li>
<li>
<code>type = "matrix"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster</a></code>
</li>
<li>
<code>type = "cor"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster</a></code>
</li>
<li>
<code>type = "violin"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point</a></code>
</li>
</ul>
<p>For example, we may wish to control the point size and transparency
in the above plot (not rendered here for space):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"violin"</span>, </span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span>, </span>
<span>     size <span class="op">=</span> <span class="fl">0.7</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="low-dimensional-projections">Low dimensional projections<a class="anchor" aria-label="anchor" href="#low-dimensional-projections"></a>
</h3>
<p>The function <code>reduce_dims</code> takes the
<code>feature_calculations</code> object and calculates either a
principal components analysis (PCA) or <em>t</em>-distributed stochastic
neighbour embedding (<em>t</em>-SNE) fit on it. This result is stored in
a custom object class called <code>low_dimension</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduce_dims.html">reduce_dims</a></span><span class="op">(</span><span class="va">feature_matrix</span>, </span>
<span>                       norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>, </span>
<span>                       unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       low_dim_method <span class="op">=</span> <span class="st">"PCA"</span>, </span>
<span>                       seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>We can similarly call <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on this object to produce a
two-dimensional scatterplot of the results:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">low_dim</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Alternatively, a <em>t</em>-SNE version can be specified in a similar
fashion, with the <code>perplexity</code> hyperparameter able to be
controlled by the user. Typical values for this range between 5 and 50,
depending on the size of the data. At lower levels of
<code>perplexity</code>, local variations tend to dominate, while at
very high levels of <code>perplexity</code>, results can be
uninterpretable as clusters can merge. See <a href="https://distill.pub/2016/misread-tsne/" class="external-link">this interactive
article</a> for a detailed review. Shaded covariance ellipses can also
be disabled when plotting <code>low_dimension</code> objects by setting
<code>show_covariance = FALSE</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduce_dims.html">reduce_dims</a></span><span class="op">(</span><span class="va">feature_matrix</span>, </span>
<span>                        norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>, </span>
<span>                        unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        low_dim_method <span class="op">=</span> <span class="st">"t-SNE"</span>, </span>
<span>                        perplexity <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">low_dim2</span>, show_covariance <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
<p>There is also the option to specify any other arguments to
<code>reduce_dims</code> that are then passed to either
<code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp</a></code> or <code><a href="https://rdrr.io/pkg/Rtsne/man/Rtsne.html" class="external-link">Rtsne::Rtsne</a></code> through the
ellipsis additional arguments. For example, you may wish to control the
maximum number of iterations (<code>max_iter</code>) and the
speed-accuracy trade-off (<code>theta</code>) in
<code><a href="https://rdrr.io/pkg/Rtsne/man/Rtsne.html" class="external-link">Rtsne::Rtsne</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduce_dims.html">reduce_dims</a></span><span class="op">(</span><span class="va">feature_matrix</span>, </span>
<span>                        norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>,</span>
<span>                        unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        low_dim_method <span class="op">=</span> <span class="st">"t-SNE"</span>, </span>
<span>                        perplexity <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>                        max_iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                        theta <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p>You can consult the documentation to get a list of potential
arguments by calling either <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">?prcomp</a></code> or
<code>?Rtsne</code>.</p>
</div>
<div class="section level3">
<h3 id="pairwise-correlations">Pairwise correlations<a class="anchor" aria-label="anchor" href="#pairwise-correlations"></a>
</h3>
<p>You can plot correlations between feature vectors using
<code>plot(type = "cor")</code> on a <code>feature_calculations</code>
object:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Similarly, you can control the normalisation type with the
<code>norm_method</code> argument and the hierarchical clustering method
with the <code>clust_method</code> argument (the example above used
defaults so manual specification was not needed).</p>
</div>
</div>
<div class="section level2">
<h2 id="time-series-classification">Time-series classification<a class="anchor" aria-label="anchor" href="#time-series-classification"></a>
</h2>
<div class="section level3">
<h3 id="feature-by-feature">Feature-by-feature<a class="anchor" aria-label="anchor" href="#feature-by-feature"></a>
</h3>
<p>Since feature-based time-series analysis has shown particular promise
for classification problems, <code>theft</code> includes functionality
for exploring group separation. The function
<code>tsfeature_classifier</code> enables you to fit a range of
classification models to enable statistical comparisons using the
resampling methodology presented in <a href="https://pakdd2023.org/wp-content/uploads/2023/05/pakdd23_w1_p3.pdf" class="external-link">this
paper</a> for a detailed review<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;T. Henderson, A. G., Bryant, and B. D. Fulcher, “Never a
Dull Moment: Distributional Properties as a Baseline for Time-Series
Classification”, 27th Pacific-Asia Conference on Knowledge Discovery and
Data Mining, 2023.&lt;/p&gt;"><sup>2</sup></a>. This function is meant to serve as a fast
answer that can be used to guide analysis and not a replacement for the
development of a careful statistical pipeline.
<code>tsfeature_classifier</code> has the following arguments:</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code>calculate_features</code> with an included <code>group</code>
column as per <code><a href="../reference/calculate_features.html">theft::calculate_features</a></code>
</li>
<li>
<code>classifier</code>—<code>function</code> specifying the
classifier to fit. Should be a function with 2 arguments:
<code>formula</code> and <code>data</code>. Please note that
<code>tsfeature_classifier</code> z-scores data prior to modelling using
the train set’s information so disabling default scaling if your
function uses it is recommended. Defaults to <code>NULL</code> which
means the following linear SVM is fit:
<code>classifier = function(formula, data){mod &lt;- e1071::svm(formula, data = data, kernel = "linear", scale = FALSE, probability = TRUE)}</code>
</li>
<li>
<code>train_size</code>—Numeric value denoting the proportion of
samples to use in the training set. Defaults to <code>0.75</code>
</li>
<li>
<code>n_resamples</code>—Integer denoting the number of resamples to
calculate. Defaults to <code>30</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether to compute
classifiers for each feature set. Defaults to <code>TRUE</code> (see
below section “Multi-feature” for more on this). If <code>FALSE</code>,
the function will instead find the best individually-performing
features</li>
<li>
<code>use_null</code>—Boolean whether to fit null models where class
labels are shuffled in order to generate a null distribution that can be
compared to performance on correct class labels. Defaults to
<code>FALSE</code>. This is known as permutation testing</li>
<li>
<code>seed</code>—Integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
<li>
<code>preference</code>— Character denoting which feature set to
keep (meaning the others will be filtered out) between
<code>"feasts"</code>, <code>"tsfeatures"</code>, and
<code>"Kats"</code> since there is considerable overlap between these
three sets. Defaults to <code>"feasts"</code>. Duplicates will
<strong>not</strong> be removed from the respective non-preferenced sets
when computing set-level results to ensure fairness. They are only
filtered out for either the construction of the set of “All features” if
<code>by_set = TRUE</code> and when computing individual feature results
(to reduce redundant calculations)</li>
</ul>
<p><em>NOTE:</em> You can apply duplicate filtering to any
<code>feature_calculations</code> object through the function
<code>filter_duplicates</code>. This function only has 2 arguments:
<code>data</code> (the <code>feature_calculations</code> object) and
<code>preference</code> (same as above). For example, if you assumed
that we calculated features from all the sets, you could run the
following upfront:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_duplicates.html">filter_duplicates</a></span><span class="op">(</span><span class="va">feature_matrix</span>, preference <span class="op">=</span> <span class="st">"feasts"</span><span class="op">)</span></span></code></pre></div>
<p>Since we are interested in individual features in this section, we
will calculate both main and null results for each feature using just
<code>5</code> resamples for efficiency (in practice, we would use
more!) with the default linear SVM:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_classifiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsfeature_classifier.html">tsfeature_classifier</a></span><span class="op">(</span><span class="va">feature_matrix</span>, by_set <span class="op">=</span> <span class="cn">FALSE</span>, n_resamples <span class="op">=</span> <span class="fl">5</span>, use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To show you how simple it is to specify a different classifier, we
can instead maybe use a radial basis function SVM (though you are
absolutely not limited to just <code>e1071</code> models! You can use
anything that can be used with R’s <code>predict</code> generic as
<code>tsfeature_classifier</code> internally constructs confusion
matrices from model predictions):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myclassifier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, kernel <span class="op">=</span> <span class="st">"radial"</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">feature_classifiers_radial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsfeature_classifier.html">tsfeature_classifier</a></span><span class="op">(</span><span class="va">feature_matrix</span>, classifier <span class="op">=</span> <span class="va">myclassifier</span>, by_set <span class="op">=</span> <span class="cn">FALSE</span>, n_resamples <span class="op">=</span> <span class="fl">5</span>, use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>While have raw classification results is useful, we often also would
like to statistical evaluate some facet of it. <code>theft</code>
includes the function <code>compare_features</code> for doing this.
<code>compare_features</code> contains the following arguments:</p>
<ul>
<li>
<code>data</code>—List object containing the classification outputs
produce by <code>tsfeature_classifier</code>
</li>
<li>
<code>metric</code>—Character denoting the classification
performance metric to use in statistical testing. Can be one of
<code>"accuracy"</code>, <code>"precision"</code>,
<code>"recall"</code>, <code>"f1"</code>. Defaults to
<code>"accuracy"</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether you want to compare
feature sets (if <code>TRUE</code>) or individual features (if
<code>FALSE</code>). Defaults to <code>TRUE</code> but this is
contingent on whether you computed by set or not in
<code>tsfeature_classifier</code>
</li>
<li>
<code>hypothesis</code>—Character denoting whether p-values should
be calculated for each feature set or feature (depending on
<code>by_set</code> argument) individually relative to the null if
<code>use_null = TRUE</code> in <code>tsfeature_classifier</code>
through <code>"null"</code>, or whether pairwise comparisons between
each set or feature should be conducted on main model fits only through
<code>"pairwise"</code>. Defaults to <code>"null"</code>
</li>
<li>
<code>p_adj</code>—Character denoting the adjustment made to
p-values for multiple comparisons. Should be a valid argument to <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/p.adjust" class="external-link"><code>stats::p.adjust</code></a>.
Defaults to <code>"none"</code> for no adjustment. <code>"holm"</code>
is recommended as a starting point if adjustments are sought</li>
</ul>
<p>We can use <code>compare_features</code> to evaluate how well each
individual feature performs relative to its empirical null distribution
(noting that we are using the defaults for the other arguments for code
cleanliness):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_vs_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_features.html">compare_features</a></span><span class="op">(</span><span class="va">feature_classifiers</span>, by_set <span class="op">=</span> <span class="cn">FALSE</span>, hypothesis <span class="op">=</span> <span class="st">"null"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">feature_vs_null</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                                            hypothesis</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_Embed2_Dist_tau_d_expfit_meandiff (null)</span></span>
<span><span class="co">#&gt; 2                                                       catch22_CO_f1ecac != catch22_CO_f1ecac (null)</span></span>
<span><span class="co">#&gt; 3                                             catch22_CO_FirstMin_ac != catch22_CO_FirstMin_ac (null)</span></span>
<span><span class="co">#&gt; 4                         catch22_CO_HistogramAMI_even_2_5 != catch22_CO_HistogramAMI_even_2_5 (null)</span></span>
<span><span class="co">#&gt; 5                                               catch22_CO_trev_1_num != catch22_CO_trev_1_num (null)</span></span>
<span><span class="co">#&gt; 6                                   catch22_DN_HistogramMode_10 != catch22_DN_HistogramMode_10 (null)</span></span>
<span><span class="co">#&gt;                                          names feature_set</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff     catch22</span></span>
<span><span class="co">#&gt; 2                            catch22_CO_f1ecac     catch22</span></span>
<span><span class="co">#&gt; 3                       catch22_CO_FirstMin_ac     catch22</span></span>
<span><span class="co">#&gt; 4             catch22_CO_HistogramAMI_even_2_5     catch22</span></span>
<span><span class="co">#&gt; 5                        catch22_CO_trev_1_num     catch22</span></span>
<span><span class="co">#&gt; 6                  catch22_DN_HistogramMode_10     catch22</span></span>
<span><span class="co">#&gt;                         original_names   metric t_statistic     p.value</span></span>
<span><span class="co">#&gt; 1 CO_Embed2_Dist_tau_d_expfit_meandiff accuracy   5.5468407 0.002583706</span></span>
<span><span class="co">#&gt; 2                            CO_f1ecac accuracy   3.5781322 0.011603187</span></span>
<span><span class="co">#&gt; 3                       CO_FirstMin_ac accuracy   5.7154761 0.002317920</span></span>
<span><span class="co">#&gt; 4             CO_HistogramAMI_even_2_5 accuracy   2.2015813 0.046244746</span></span>
<span><span class="co">#&gt; 5                        CO_trev_1_num accuracy   1.4446302 0.111034114</span></span>
<span><span class="co">#&gt; 6                  DN_HistogramMode_10 accuracy   0.4082483 0.352000000</span></span></code></pre></div>
<p>Or to conduct pairwise comparisons between individual features:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairwise_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_features.html">compare_features</a></span><span class="op">(</span><span class="va">feature_classifiers</span>, by_set <span class="op">=</span> <span class="cn">FALSE</span>, hypothesis <span class="op">=</span> <span class="st">"pairwise"</span>, p_adj <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairwise_features</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                         hypothesis</span></span>
<span><span class="co">#&gt; 1                catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 2           catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 3 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 4            catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 5      catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 6       catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_DN_HistogramMode_5</span></span>
<span><span class="co">#&gt;                                        names_a                          names_b</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff                catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 2 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff           catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 3 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 4 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff            catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 5 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff      catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 6 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff       catch22_DN_HistogramMode_5</span></span>
<span><span class="co">#&gt;     metric t_statistic      p.value p_value_adj</span></span>
<span><span class="co">#&gt; 1 accuracy  -1.3093073 1.302873e-01  1.00000000</span></span>
<span><span class="co">#&gt; 2 accuracy   0.3726780 3.641474e-01  1.00000000</span></span>
<span><span class="co">#&gt; 3 accuracy  -0.5871366 2.943266e-01  1.00000000</span></span>
<span><span class="co">#&gt; 4 accuracy   4.0273190 7.884261e-03  1.00000000</span></span>
<span><span class="co">#&gt; 5 accuracy  22.8619043 1.084307e-05  0.00250475</span></span>
<span><span class="co">#&gt; 6 accuracy   7.2623980 9.545688e-04  0.18041351</span></span></code></pre></div>
<p>We can then use <code>ggplot2</code> to summarise and visualise our
results. Here is a pairwise correlation plot between the top 10 features
in <code>catch22</code> for this toy problem. We are just simply
filtering the original full feature data and making use of the
<code>plot</code> generic defined for objects of class
<code>feature_calculations</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10</span> <span class="op">&lt;-</span> <span class="va">feature_vs_null</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">p.value</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">feature_set</span>, <span class="va">original_names</span>, <span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="va">feature_matrix</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_set</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span><span class="op">$</span><span class="va">feature_set</span> <span class="op">&amp;</span> <span class="va">names</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span><span class="op">$</span><span class="va">original_names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"feature_calculations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can also easily draw a violin plot of the top 10 features to
visualise the distributions by group:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix_filt</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">values</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.9</span>, position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Class"</span>,</span>
<span>                y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                 panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 strip.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">names</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="multi-feature">Multi-feature<a class="anchor" aria-label="anchor" href="#multi-feature"></a>
</h3>
<p>Since <code>theft</code> contains entire sets of features, we can
also use <code>tsfeature_classifier</code> to compare them at the set
level through the <code>by_set</code> argument:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">set_classifiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsfeature_classifier.html">tsfeature_classifier</a></span><span class="op">(</span><span class="va">feature_matrix</span>, by_set <span class="op">=</span> <span class="cn">TRUE</span>, n_resamples <span class="op">=</span> <span class="fl">5</span>, use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">set_classifiers</span><span class="op">)</span></span>
<span><span class="co">#&gt; $TrainTestSizes</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        135         45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ClassificationResults</span></span>
<span><span class="co">#&gt;    model_type resample   accuracy mean_precision mean_recall mean_f1_score</span></span>
<span><span class="co">#&gt; 1        Main        1 0.73333333      0.7731481   0.7291667     0.7379157</span></span>
<span><span class="co">#&gt; 2        Main        2 0.71111111      0.7250000   0.7235450     0.7210240</span></span>
<span><span class="co">#&gt; 3        Main        3 0.75555556      0.7643519   0.7500000     0.7481076</span></span>
<span><span class="co">#&gt; 4        Main        4 0.71111111      0.7351852   0.7389499     0.7256702</span></span>
<span><span class="co">#&gt; 5        Main        5 0.80000000      0.8310185   0.8132937     0.8192783</span></span>
<span><span class="co">#&gt; 6        Null        1 0.06666667      0.0915404   0.1083333     0.1173046</span></span>
<span><span class="co">#&gt; 7        Null        2 0.08888889      0.0912037   0.0907967     0.1313582</span></span>
<span><span class="co">#&gt; 8        Null        3 0.13333333      0.1744108   0.1599327     0.2199786</span></span>
<span><span class="co">#&gt; 9        Null        4 0.08888889      0.1100589   0.1079365     0.1306333</span></span>
<span><span class="co">#&gt; 10       Null        5 0.28888889      0.2736532   0.2613636     0.3179221</span></span>
<span><span class="co">#&gt; 11       Main        1 0.73333333      0.7731481   0.7291667     0.7379157</span></span>
<span><span class="co">#&gt; 12       Main        2 0.71111111      0.7250000   0.7235450     0.7210240</span></span>
<span><span class="co">#&gt; 13       Main        3 0.75555556      0.7643519   0.7500000     0.7481076</span></span>
<span><span class="co">#&gt; 14       Main        4 0.71111111      0.7351852   0.7389499     0.7256702</span></span>
<span><span class="co">#&gt; 15       Main        5 0.80000000      0.8310185   0.8132937     0.8192783</span></span>
<span><span class="co">#&gt; 16       Null        1 0.06666667      0.0915404   0.1083333     0.1173046</span></span>
<span><span class="co">#&gt; 17       Null        2 0.08888889      0.0912037   0.0907967     0.1313582</span></span>
<span><span class="co">#&gt; 18       Null        3 0.13333333      0.1744108   0.1599327     0.2199786</span></span>
<span><span class="co">#&gt; 19       Null        4 0.08888889      0.1100589   0.1079365     0.1306333</span></span>
<span><span class="co">#&gt; 20       Null        5 0.28888889      0.2736532   0.2613636     0.3179221</span></span>
<span><span class="co">#&gt;     feature_set</span></span>
<span><span class="co">#&gt; 1  All features</span></span>
<span><span class="co">#&gt; 2  All features</span></span>
<span><span class="co">#&gt; 3  All features</span></span>
<span><span class="co">#&gt; 4  All features</span></span>
<span><span class="co">#&gt; 5  All features</span></span>
<span><span class="co">#&gt; 6  All features</span></span>
<span><span class="co">#&gt; 7  All features</span></span>
<span><span class="co">#&gt; 8  All features</span></span>
<span><span class="co">#&gt; 9  All features</span></span>
<span><span class="co">#&gt; 10 All features</span></span>
<span><span class="co">#&gt; 11      catch22</span></span>
<span><span class="co">#&gt; 12      catch22</span></span>
<span><span class="co">#&gt; 13      catch22</span></span>
<span><span class="co">#&gt; 14      catch22</span></span>
<span><span class="co">#&gt; 15      catch22</span></span>
<span><span class="co">#&gt; 16      catch22</span></span>
<span><span class="co">#&gt; 17      catch22</span></span>
<span><span class="co">#&gt; 18      catch22</span></span>
<span><span class="co">#&gt; 19      catch22</span></span>
<span><span class="co">#&gt; 20      catch22</span></span></code></pre></div>
<p>Since we only calculated <code>catch22</code> in this vignette, the
only other comparate set is <code>"All features"</code> which is
automatically always included by default. This means they will both have
identical results, but this functionality becomes more powerful if other
feature sets were also calculated. Similar to the individual feature
case, we can also use <code>ggplot2</code> to summarise our findings.
Here is a comparison of mean accuracy <span class="math inline">\(\pm
1SD\)</span> between feature sets:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">set_classifiers</span><span class="op">$</span><span class="va">ClassificationResults</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">model_type</span> <span class="op">==</span> <span class="st">"Main"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">feature_set</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span>,</span>
<span>                   lower <span class="op">=</span> <span class="va">mu</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   upper <span class="op">=</span> <span class="va">mu</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">feature_set</span>, <span class="op">-</span><span class="va">mu</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mu</span>, colour <span class="op">=</span> <span class="va">feature_set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Feature set"</span>,</span>
<span>                y <span class="op">=</span> <span class="st">"Classification accuracy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                 panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theft_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;"></p>
<p>As you can see, given that we only computed <code>catch22</code> the
plot is not super informative, but had we computed others, it would
provide a fast summary of average performance at the set level—and with
a useful reference point of the potentially huge set of all calculated
features.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-and-processing-hctsa-formatted-files">Reading and processing hctsa-formatted files<a class="anchor" aria-label="anchor" href="#reading-and-processing-hctsa-formatted-files"></a>
</h2>
<p>As <code>theft</code> is based on the foundations laid by <a href="https://github.com/benfulcher/hctsa" class="external-link"><code>hctsa</code></a>, there
is also functionality for reading in <code>hctsa</code>-formatted Matlab
files and automatically processing them into tidy dataframes ready for
feature extraction in <code>theft</code>. The
<code>process_hctsa_file</code> function takes a string filepath to the
Matlab file and does all the work for you, returning a dataframe with
naming conventions consistent with other <code>theft</code>
functionality. As per <code>hctsa</code> specifications for <a href="https://hctsa-users.gitbook.io/hctsa-manual/calculating/input_files" class="external-link">Input
File Format 1</a>, this file should have 3 variables with the following
exact names: <code>timeSeriesData</code>, <code>labels</code>, and
<code>keywords</code>. The filepath can be a local drive path or a
URL.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Trent Henderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
